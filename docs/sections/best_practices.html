<!-- BEST PRACTICES SECTION -->
<section id="best-practices" class="py-20 px-6 bg-white dark:bg-gray-800">
  <div class="container mx-auto max-w-6xl">
    <div class="text-center mb-16">
      <span class="badge badge-purple mb-4">Python Fundamentals #7</span>
      <h2 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">
        <i class="fas fa-star mr-3"></i>Python Best Practices
      </h2>
      <p class="text-xl text-gray-600 dark:text-gray-400">
        Industry-standard patterns, idioms, and performance tips
      </p>
    </div>

    <!-- Context Managers -->
    <div class="mb-12">
      <h3 class="text-3xl font-bold mb-6">üîí Pengelola Konteks (Context Managers)</h3>

      <div class="bg-white dark:bg-gray-700 p-6 rounded-xl shadow-lg">
        <div class="code-block mb-4">
          <button class="copy-btn bg-purple-500 text-white px-2 py-1 rounded text-sm"
            onclick="copyCode(this)">Copy</button>
          <pre class="rounded-lg"><code class="language-python"># app.py - File I/O with context manager
with open(path, "w", newline="") as f:
    writer = csv.writer(f)
    writer.writerow(["t (s)", "F (N)", "P_total (kg¬∑m/s)", "KE_total (J)"])
    for i in range(len(self.time_log)):
        writer.writerow([...])
# File automatically closed here, even if exception occurs!

# Without with statement (BAD):
f = open(path, "w")
try:
    writer = csv.writer(f)
    # ... write data
finally:
    f.close()  # Must manually close</code></pre>
        </div>

        <div class="callout success">
          <h4 class="font-bold mb-2">‚úÖ Kenapa Pakai 'with'?</h4>
          <ul class="text-sm space-y-1">
            <li>‚Ä¢ <strong>Otomatis bersih-bersih:</strong> File ditutup otomatis</li>
            <li>‚Ä¢ <strong>Aman dari error:</strong> Tetap dibersihkan meski ada masalah</li>
            <li>‚Ä¢ <strong>Mudah dibaca:</strong> Jelas maksudnya - "bekerja dengan file ini"</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- NumPy Vectorization -->
    <div class="mb-12">
      <h3 class="text-3xl font-bold mb-6">‚ö° Vektorisasi NumPy (Hitung Cepat)</h3>

      <div class="grid md:grid-cols-2 gap-6">
        <div class="comparison-box bad">
          <h4 class="font-bold text-red-600 mb-3">‚ùå Lambat: Satu-persatu</h4>
          <div class="code-block">
            <pre class="rounded-lg text-sm"><code class="language-python"># Manual element operations (SLOW!)
self.pos_x += self.vel_x * dt
self.pos_y += self.vel_y * dt

# Manual distance calc
dx = x1 - x2
dy = y1 - y2
dist = sqrt(dx*dx + dy*dy)</code></pre>
          </div>
        </div>

        <div class="comparison-box good">
          <h4 class="font-bold text-green-600 mb-3">‚úÖ Cepat: Sekaligus (Vektor)</h4>
          <div class="code-block">
            <pre class="rounded-lg text-sm"><code class="language-python"># ball.py - Vector operation (FAST!)
self.position += self.velocity * dt
# Operates on ENTIRE array at once

# physics.py - Vector distance (FAST!)
dist = np.linalg.norm(pos_diff)
# Optimized C implementation</code></pre>
          </div>
        </div>
      </div>

      <div class="highlight-box mt-6">
        <h4 class="font-bold text-lg mb-3">üöÄ Tips Kecepatan: Pakai NumPy untuk Matematika</h4>
        <p class="text-sm mb-2">Operasi NumPy 10-100x lebih cepat dari loop biasa karena dibuat pakai bahasa C.</p>
        <ul class="text-sm space-y-1">
          <li>‚Ä¢ <strong>Vector operations:</strong> <code>a + b * c</code> instead of loops</li>
          <li>‚Ä¢ <strong>Built-in functions:</strong> <code>np.linalg.norm()</code>, <code>np.dot()</code></li>
          <li>‚Ä¢ <strong>Broadcasting:</strong> Operations on arrays of different shapes</li>
        </ul>
      </div>
    </div>

    <!-- Defensive Programming -->
    <div class="mb-12">
      <h3 class="text-3xl font-bold mb-6">üõ°Ô∏è Pemrograman Defensif (Hati-Hati)</h3>

      <div class="bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 p-6 rounded-xl">
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <h4 class="font-bold text-lg mb-3">Validasi Input</h4>
            <div class="code-block">
              <pre class="rounded-lg text-sm"><code class="language-python"># app.py - Validate input
try:
    mass = float(entry.get())
except ValueError:
    messagebox.showerror(
        "Error",
        "Input tidak valid!"
    )
    return  # Stop execution</code></pre>
            </div>
          </div>
          <div>
            <h4 class="font-bold text-lg mb-3">Cek Nilai Kosong</h4>
            <div class="code-block">
              <pre class="rounded-lg text-sm"><code class="language-python"># app.py - Check if exists
if self.center_of_mass_id is None:
    # Create new
else:
    # Update existing

# app.py - Early exit if no path
if not path:
    return</code></pre>
            </div>
          </div>
        </div>

        <div class="callout warning">
          <h4 class="font-bold mb-2">‚ö†Ô∏è Aturan Pemrograman Defensif</h4>
          <ul class="text-sm space-y-1">
            <li>‚Ä¢ <strong>Validasi semua input</strong> - jangan percaya data dari luar</li>
            <li>‚Ä¢ <strong>Cek None/kosong</strong> sebelum pakai objek</li>
            <li>‚Ä¢ <strong>Jaga-jaga kasus aneh:</strong> list kosong, pembagian nol, angka negatif</li>
            <li>‚Ä¢ <strong>Kasih pesan error yang jelas</strong> ke user</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Data Structures -->
    <div class="mb-12">
      <h3 class="text-3xl font-bold mb-6">üóÉÔ∏è Pilih Struktur Data yang Pas</h3>

      <div class="grid md:grid-cols-2 gap-6">
        <div class="bg-white dark:bg-gray-700 p-6 rounded-xl shadow-lg">
          <h4 class="font-bold text-lg mb-3">Deque untuk Buffer Tetap</h4>
          <div class="code-block">
            <pre class="rounded-lg text-sm"><code class="language-python"># ball.py - Sempurna untuk efek jejak (trails)
self.trail_points = deque(maxlen=TRAIL_MAX_LENGTH)

# Otomatis hapus data terlama saat penuh
self.trail_points.append(new_point)
# Tidak perlu urus ukuran manual!</code></pre>
          </div>
          <p class="text-sm mt-2 text-green-600 dark:text-green-400">‚úÖ O(1) append, batas ukuran otomatis</p>
        </div>

        <div class="bg-white dark:bg-gray-700 p-6 rounded-xl shadow-lg">
          <h4 class="font-bold text-lg mb-3">Dict untuk Pencarian Cepat</h4>
          <div class="code-block">
            <pre class="rounded-lg text-sm"><code class="language-python"># app.py - Pelacakan Status
contact_tracker = {
    "in_contact": False,
    "impulse_accumulated": 0.0,
    "force_samples": []
}
# Akses dengan kunci: O(1)</code></pre>
          </div>
          <p class="text-sm mt-2 text-green-600 dark:text-green-400">‚úÖ Akses pakai nama bukan indeks</p>
        </div>
      </div>
    </div>

    <!-- Python Idioms -->
    <div class="mb-12">
      <h3 class="text-3xl font-bold mb-6">üêç Gaya Bahasa Python (Idiom)</h3>

      <div class="grid md:grid-cols-2 gap-6">
        <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-xl">
          <h4 class="font-bold mb-3">Tuple Unpacking (Buka Bungkus)</h4>
          <div class="code-block">
            <pre class="rounded-lg text-sm"><code class="language-python"># ball.py - Buka tuple dalam loop
for index, (x, y) in enumerate(trail_points):
    # index, x, y semua tersedia

# Multiple assignment (tukar posisi)
a, b = b, a  # Tukar nilai</code></pre>
          </div>
        </div>

        <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-xl">
          <h4 class="font-bold mb-3">Negative Indexing (Indeks Negatif)</h4>
          <div class="code-block">
            <pre class="rounded-lg text-sm"><code class="language-python"># app.py - Elemen terakhir dari log
last = momentum_log[-1]

# 5 elemen terakhir
recent = time_log[-5:]</code></pre>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white p-8 rounded-2xl">
      <h3 class="text-3xl font-bold mb-6 text-center">üéì Poin Penting</h3>
      <div class="grid md:grid-cols-2 gap-6">
        <div>
          <h4 class="font-bold text-lg mb-3 text-yellow-300">‚úÖ SELALU Lakukan</h4>
          <ul class="space-y-2 text-sm">
            <li>‚Ä¢ Pakai petunjuk tipe (hints) untuk fungsi</li>
            <li>‚Ä¢ Tulis docstrings (keterangan)</li>
            <li>‚Ä¢ Pakai context managers (with)</li>
            <li>‚Ä¢ Validasi input user</li>
            <li>‚Ä¢ Pilih struktur data yang pas</li>
            <li>‚Ä¢ Pakai NumPy untuk matematika</li>
            <li>‚Ä¢ Ikuti penamaan PEP 8</li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold text-lg mb-3 text-yellow-300">‚ùå JANGAN Lakukan</h4>
          <ul class="space-y-2 text-sm">
            <li>‚Ä¢ Ulangi kode (Gunakan DRY)</li>
            <li>‚Ä¢ Bersarang terlalu dalam (pakai guards)</li>
            <li>‚Ä¢ Nama variabel aneh/rahasia</li>
            <li>‚Ä¢ Tangkap semua error buta-buta</li>
            <li>‚Ä¢ Lupa tutup resource (file/database)</li>
            <li>‚Ä¢ Taruh banyak tugas di satu fungsi</li>
            <li>‚Ä¢ Asumsi input pasti benar</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>